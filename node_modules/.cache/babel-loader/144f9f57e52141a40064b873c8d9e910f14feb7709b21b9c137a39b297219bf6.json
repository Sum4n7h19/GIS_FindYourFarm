{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{Alert,Button}from\"react-bootstrap\";import Menu from\"./Menu\";import Map from\"./Map\";import Details from\"./Details\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const HomeScreen=()=>{const[json,setJson]=useState(null);const[data,setData]=useState(null);const[villageInfo,setVillageInfo]=useState([]);const[errorMessage,setErrorMessage]=useState(\"\");const[showAlert,setShowAlert]=useState(false);const getData=data=>{setJson(null);setVillageInfo(data);if(data!==null){axios.get(\"http://localhost:5000/parcelapi/\".concat(data[1],\"/\").concat(data[0])).then(response=>{if(!response.data){throw new Error(\"Empty response or response data is not valid JSON\");}setJson(response.data[0]);setData(response.data);}).catch(error=>{// Handle CORS error\nif(error.response&&error.response.status===403){setErrorMessage(\"Access to the resource is forbidden (CORS issue).\");}else{setErrorMessage(\"Incorrect SurveyNo.\");}setShowAlert(true);console.error(\"Error fetching data:\",error);});}};useEffect(()=>{if(showAlert){const timeout=setTimeout(()=>{setShowAlert(false);window.location.reload();},3000);return()=>clearTimeout(timeout);}},[showAlert]);const info=data;const clickHandler=async()=>{try{axios.get(\"http://localhost:5000/downloads/\".concat(villageInfo[1],\"/\").concat(villageInfo[0]),{responseType:\"arraybuffer\"});window.location.reload();}catch(error){if(error.response&&error.response.status===403){setErrorMessage(\"Access to the resource is forbidden (CORS issue).\");}else{setErrorMessage(\"Internal Server Error.\");}setShowAlert(true);console.error(\"Error fetching data:\",error);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[errorMessage&&/*#__PURE__*/_jsx(Alert,{className:\"alert\",variant:\"danger\",children:/*#__PURE__*/_jsx(\"div\",{className:\"alert-content\",children:errorMessage})}),/*#__PURE__*/_jsx(Menu,{onSubmit:getData}),info&&/*#__PURE__*/_jsx(Details,{data:info}),json&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Map,{data:json}),/*#__PURE__*/_jsx(\"div\",{className:\"bbox\",children:/*#__PURE__*/_jsx(Button,{onClick:clickHandler,children:\"Download Image\"})})]})]});};export default HomeScreen;","map":{"version":3,"names":["React","useState","useEffect","axios","Alert","Button","Menu","Map","Details","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","HomeScreen","json","setJson","data","setData","villageInfo","setVillageInfo","errorMessage","setErrorMessage","showAlert","setShowAlert","getData","get","concat","then","response","Error","catch","error","status","console","timeout","setTimeout","window","location","reload","clearTimeout","info","clickHandler","responseType","children","className","variant","onSubmit","onClick"],"sources":["C:/Users/wwwsu/Desktop/Parcel/findyourfarm/src/Components/HomeScreen.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Alert, Button } from \"react-bootstrap\";\r\nimport Menu from \"./Menu\";\r\nimport Map from \"./Map\";\r\nimport Details from \"./Details\";\r\n\r\nconst HomeScreen = () => {\r\n  const [json, setJson] = useState(null);\r\n  const [data, setData] = useState(null);\r\n  const [villageInfo, setVillageInfo] = useState([]);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [showAlert, setShowAlert] = useState(false);\r\n\r\n  const getData = (data) => {\r\n    setJson(null);\r\n    setVillageInfo(data);\r\n    if (data !== null) {\r\n      axios\r\n        .get(`http://localhost:5000/parcelapi/${data[1]}/${data[0]}`)\r\n        .then((response) => {\r\n          if (!response.data) {\r\n            throw new Error(\r\n              \"Empty response or response data is not valid JSON\"\r\n            );\r\n          }\r\n          setJson(response.data[0]);\r\n          setData(response.data);\r\n        })\r\n        .catch((error) => {\r\n          // Handle CORS error\r\n          if (error.response && error.response.status === 403) {\r\n            setErrorMessage(\r\n              \"Access to the resource is forbidden (CORS issue).\"\r\n            );\r\n          } else {\r\n            setErrorMessage(\"Incorrect SurveyNo.\");\r\n          }\r\n          setShowAlert(true);\r\n          console.error(\"Error fetching data:\", error);\r\n        });\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (showAlert) {\r\n      const timeout = setTimeout(() => {\r\n        setShowAlert(false);\r\n        window.location.reload();\r\n      }, 3000);\r\n      return () => clearTimeout(timeout);\r\n    }\r\n  }, [showAlert]);\r\n\r\n  const info = data;\r\n  const clickHandler = async () => {\r\n    try {\r\n      axios.get(\r\n        `http://localhost:5000/downloads/${villageInfo[1]}/${villageInfo[0]}`,\r\n        { responseType: \"arraybuffer\" }\r\n      );window.location.reload();\r\n    } catch (error) {\r\n        if (error.response && error.response.status === 403) {\r\n            setErrorMessage(\r\n              \"Access to the resource is forbidden (CORS issue).\"\r\n            );\r\n          } else {\r\n            setErrorMessage(\"Internal Server Error.\");\r\n          }\r\n          setShowAlert(true);\r\n          console.error(\"Error fetching data:\", error);\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      {errorMessage && (\r\n        <Alert className=\"alert\" variant=\"danger\">\r\n          <div className=\"alert-content\">{errorMessage}</div>\r\n        </Alert>\r\n      )}\r\n      <Menu onSubmit={getData} />\r\n      {info && <Details data={info} />}\r\n      {json && (\r\n        <>\r\n          <Map data={json} />\r\n          <div className=\"bbox\">\r\n            <Button onClick={clickHandler}>Download Image</Button>\r\n          </div>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default HomeScreen;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}